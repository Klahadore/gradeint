<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gradient - Processing</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/loading.css">
    <link rel="stylesheet" href="../styles/sparkles.css">
</head>
<body>
    <div class="sparkles-container"></div>
    <nav class="main-nav">
        <!-- ...existing nav code... -->
    </nav>
    <div class="loading-container">
        <img src="../assets/gradient_large.png" alt="Gradient Logo" class="loading-logo">
        <h2 class="loading-text">Grading Work...</h2>
        <div class="loading-spinner"></div>
        <button id="downloadBtn" class="download-button" style="display: none;">
            Download Marked-Up PDF
        </button>
    </div>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const filename = urlParams.get('file');

        async function processAndShow() {
            try {
                // Store both filename and full path in localStorage
                localStorage.setItem('currentPDF', filename);
                localStorage.setItem('pdfPath', `/Users/jibranhutchins/developer/gradeint/uploads/marked_up/${filename}`);
                
                console.log('Stored PDF path:', localStorage.getItem('pdfPath'));
                
                // Short delay then redirect
                await new Promise(resolve => setTimeout(resolve, 1000));
                window.location.href = 'dashboard.html';
            } catch (error) {
                console.error('Error:', error);
                document.querySelector('.loading-text').textContent = 'Error processing PDF';
            }
        }

        document.addEventListener('DOMContentLoaded', processAndShow);
    </script>
    <script src="../js/sparkles.js"></script>
</body>
</html>
